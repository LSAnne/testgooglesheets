<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Client Workout Portal</title>
</head>
<body>
  <h2>Login</h2>
  <input type="email" id="email" placeholder="Enter your email">
  <button onclick="loadWorkouts()">Login</button>

  <div id="workout-section" style="display:none;">
    <h3>Your Workout Plan</h3>
    <form id="workout-form"></form>
    <button onclick="submitWorkout()">Submit Workout</button>
  </div>

  <script>
    const scriptUrl = 'YOUR_DEPLOYED_WEB_APP_URL';

    function loadWorkouts() {
      const email = document.getElementById('email').value;
      fetch(scriptUrl + '?action=getWorkouts&email=' + encodeURIComponent(email))
        .then(response => response.json())
        .then(data => {
          document.getElementById('workout-section').style.display = 'block';
          const form = document.getElementById('workout-form');
          form.innerHTML = '';
          data.forEach((item, index) => {
            form.innerHTML += `
              <div>
                <strong>${item.exercise} (Session ${item.session})</strong><br>
                Set 1 Target: ${item.set1Target} <br>
                Set 1 Actual: <input type="text" id="set1Actual-${index}"><br>
                Set 3 Target: ${item.set3Target} <br>
                Set 3 Actual: <input type="text" id="set3Actual-${index}"><br>
                RPE: <input type="text" id="rpe-${index}"><br>
                Notes: <input type="text" id="notes-${index}"><br>
              </div><hr>`;
          });
        });
    }

    function submitWorkout() {
      const email = document.getElementById('email').value;
      const form = document.getElementById('workout-form');
      const workoutDivs = form.querySelectorAll('div');
      let logData = [];

      workoutDivs.forEach((div, i) => {
        const exerciseTitle = div.querySelector('strong').textContent;
        const session = exerciseTitle.match(/Session (\d+)/)[1];
        const exercise = exerciseTitle.split(' (')[0];
        const set1Actual = document.getElementById(`set1Actual-${i}`).value;
        const set3Actual = document.getElementById(`set3Actual-${i}`).value;
        const rpe = document.getElementById(`rpe-${i}`).value;
        const notes = document.getElementById(`notes-${i}`).value;

        logData.push({ session, exercise, set1Actual, set3Actual, rpe, notes });
      });

      fetch(scriptUrl, {
        method: 'POST',
        body: JSON.stringify({ action: 'logWorkout', email: email, logData: logData }),
        headers: { 'Content-Type': 'application/json' }
      }).then(() => alert('Workout logged!'));
    }
  </script>
</body>
</html>